cmake_minimum_required(VERSION 3.10)
project(DistributedSystem)

# ????????????? ???????? C++ (????????, C++17)
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# ?????????? pkg-config ??? ?????? ZeroMQ
find_package(PkgConfig REQUIRED)
pkg_check_modules(ZEROMQ REQUIRED libzmq)

# ???????? ?????????? ? ????????? ???????
include_directories(${CMAKE_SOURCE_DIR}/include ${ZEROMQ_INCLUDE_DIRS})

# ?????? ???????? ?????? ??? ???????????? ????
set(MANAGE_MAIN_SOURCES
    src/manage_main.cpp
    src/manage_node.cpp
    include/manage_node.h
    include/tree.hpp
    include/msg.h
)

# ?????? ???????? ?????? ??? ??????????????? ????
set(NODE_SOURCES
    src/node.cpp
    include/tree.hpp
    include/msg.h  # ????????? msg.h
)

# ?????? ???????????? ????
add_executable(manage_main ${MANAGE_MAIN_SOURCES})
target_link_libraries(manage_main ${ZEROMQ_LIBRARIES})

# ?????? ??????????????? ????
add_executable(node ${NODE_SOURCES})
target_link_libraries(node ${ZEROMQ_LIBRARIES})

# ????????? ??????????? ?????? ? ????? bin
install(TARGETS manage_main node DESTINATION bin)